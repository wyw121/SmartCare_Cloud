-- 智慧医养平台 - 健康状态测试数据
-- 创建多样化的健康状态数据用于测试年龄段健康分布功能
-- 清空现有老人数据（谨慎使用）
-- TRUNCATE TABLE elderly;
-- 插入测试用的老人数据，包含各种健康状态
INSERT INTO elderly (
    name,
    gender,
    birth_date,
    phone,
    address,
    health_status,
    care_level,
    emergency_contact,
    emergency_phone,
    created_time,
    updated_time
  )
VALUES -- 60-70岁年龄段
  (
    '张三',
    '男',
    '1955-03-15',
    '13800138001',
    '北京市朝阳区',
    'NORMAL',
    1,
    '张小明',
    '13900139001',
    NOW(),
    NOW()
  ),
  (
    '李四',
    '女',
    '1958-07-20',
    '13800138002',
    '北京市海淀区',
    'ATTENTION',
    1,
    '李小红',
    '13900139002',
    NOW(),
    NOW()
  ),
  (
    '王五',
    '男',
    '1960-12-05',
    '13800138003',
    '北京市西城区',
    'WARNING',
    2,
    '王小军',
    '13900139003',
    NOW(),
    NOW()
  ),
  (
    '赵六',
    '女',
    '1962-04-18',
    '13800138004',
    '北京市东城区',
    '健康',
    1,
    '赵小华',
    '13900139004',
    NOW(),
    NOW()
  ),
  (
    '孙七',
    '男',
    '1959-09-25',
    '13800138005',
    '北京市丰台区',
    '亚健康',
    1,
    '孙小刚',
    '13900139005',
    NOW(),
    NOW()
  ),
  (
    '周八',
    '女',
    '1961-11-30',
    '13800138006',
    '北京市石景山区',
    '慢性病',
    2,
    '周小丽',
    '13900139006',
    NOW(),
    NOW()
  ),
  (
    '吴九',
    '男',
    '1963-02-14',
    '13800138007',
    '北京市房山区',
    '高血压',
    2,
    '吴小明',
    '13900139007',
    NOW(),
    NOW()
  ),
  (
    '郑十',
    '女',
    '1957-06-08',
    '13800138008',
    '北京市通州区',
    '糖尿病',
    2,
    '郑小红',
    '13900139008',
    NOW(),
    NOW()
  ),
  -- 70-80岁年龄段
  (
    '陈一',
    '男',
    '1945-01-10',
    '13800138009',
    '北京市顺义区',
    'NORMAL',
    1,
    '陈小伟',
    '13900139009',
    NOW(),
    NOW()
  ),
  (
    '林二',
    '女',
    '1948-05-22',
    '13800138010',
    '北京市昌平区',
    'ATTENTION',
    2,
    '林小芳',
    '13900139010',
    NOW(),
    NOW()
  ),
  (
    '黄三',
    '男',
    '1950-08-15',
    '13800138011',
    '北京市大兴区',
    'WARNING',
    2,
    '黄小勇',
    '13900139011',
    NOW(),
    NOW()
  ),
  (
    '刘四',
    '女',
    '1952-12-03',
    '13800138012',
    '北京市门头沟区',
    '健康',
    1,
    '刘小玲',
    '13900139012',
    NOW(),
    NOW()
  ),
  (
    '杨五',
    '男',
    '1946-03-28',
    '13800138013',
    '北京市平谷区',
    '亚健康',
    1,
    '杨小军',
    '13900139013',
    NOW(),
    NOW()
  ),
  (
    '何六',
    '女',
    '1949-07-12',
    '13800138014',
    '北京市怀柔区',
    '慢性病',
    2,
    '何小艳',
    '13900139014',
    NOW(),
    NOW()
  ),
  (
    '许七',
    '男',
    '1951-10-06',
    '13800138015',
    '北京市密云区',
    '心脏病',
    3,
    '许小峰',
    '13900139015',
    NOW(),
    NOW()
  ),
  (
    '邓八',
    '女',
    '1947-04-19',
    '13800138016',
    '北京市延庆区',
    '高风险',
    3,
    '邓小娟',
    '13900139016',
    NOW(),
    NOW()
  ),
  -- 80-90岁年龄段
  (
    '梁九',
    '男',
    '1935-02-28',
    '13800138017',
    '上海市黄浦区',
    'NORMAL',
    2,
    '梁小强',
    '13900139017',
    NOW(),
    NOW()
  ),
  (
    '蔡十',
    '女',
    '1938-06-14',
    '13800138018',
    '上海市徐汇区',
    'ATTENTION',
    2,
    '蔡小敏',
    '13900139018',
    NOW(),
    NOW()
  ),
  (
    '宋一',
    '男',
    '1940-09-08',
    '13800138019',
    '上海市长宁区',
    'WARNING',
    3,
    '宋小刚',
    '13900139019',
    NOW(),
    NOW()
  ),
  (
    '韩二',
    '女',
    '1942-01-25',
    '13800138020',
    '上海市静安区',
    '健康',
    2,
    '韩小丽',
    '13900139020',
    NOW(),
    NOW()
  ),
  (
    '冯三',
    '男',
    '1936-05-17',
    '13800138021',
    '上海市普陀区',
    '亚健康',
    2,
    '冯小明',
    '13900139021',
    NOW(),
    NOW()
  ),
  (
    '谢四',
    '女',
    '1939-08-11',
    '13800138022',
    '上海市虹口区',
    '慢性病',
    3,
    '谢小红',
    '13900139022',
    NOW(),
    NOW()
  ),
  (
    '唐五',
    '男',
    '1941-11-23',
    '13800138023',
    '上海市杨浦区',
    '严重',
    3,
    '唐小伟',
    '13900139023',
    NOW(),
    NOW()
  ),
  (
    '曹六',
    '女',
    '1937-04-05',
    '13800138024',
    '上海市闵行区',
    '危重',
    3,
    '曹小芳',
    '13900139024',
    NOW(),
    NOW()
  ),
  -- 90岁以上年龄段
  (
    '朱七',
    '男',
    '1925-07-12',
    '13800138025',
    '广州市天河区',
    'NORMAL',
    2,
    '朱小军',
    '13900139025',
    NOW(),
    NOW()
  ),
  (
    '马八',
    '女',
    '1928-10-30',
    '13800138026',
    '广州市越秀区',
    'ATTENTION',
    3,
    '马小玲',
    '13900139026',
    NOW(),
    NOW()
  ),
  (
    '高九',
    '男',
    '1930-03-18',
    '13800138027',
    '广州市海珠区',
    'WARNING',
    3,
    '高小勇',
    '13900139027',
    NOW(),
    NOW()
  ),
  (
    '秦十',
    '女',
    '1932-06-22',
    '13800138028',
    '广州市荔湾区',
    '健康',
    2,
    '秦小艳',
    '13900139028',
    NOW(),
    NOW()
  ),
  (
    '董一',
    '男',
    '1926-09-15',
    '13800138029',
    '广州市白云区',
    '亚健康',
    3,
    '董小峰',
    '13900139029',
    NOW(),
    NOW()
  ),
  (
    '袁二',
    '女',
    '1929-12-08',
    '13800138030',
    '广州市黄埔区',
    '慢性病',
    3,
    '袁小娟',
    '13900139030',
    NOW(),
    NOW()
  ),
  (
    '薛三',
    '男',
    '1931-02-26',
    '13800138031',
    '广州市番禺区',
    '重病',
    3,
    '薛小强',
    '13900139031',
    NOW(),
    NOW()
  ),
  (
    '范四',
    '女',
    '1927-05-14',
    '13800138032',
    '广州市花都区',
    '危险',
    3,
    '范小敏',
    '13900139032',
    NOW(),
    NOW()
  ),
  -- 添加一些空值和特殊状态的数据
  (
    '特殊一',
    '男',
    '1955-01-01',
    '13800138033',
    '测试地址1',
    '',
    1,
    '联系人1',
    '13900139033',
    NOW(),
    NOW()
  ),
  (
    '特殊二',
    '女',
    '1945-06-15',
    '13800138034',
    '测试地址2',
    NULL,
    2,
    '联系人2',
    '13900139034',
    NOW(),
    NOW()
  ),
  (
    '特殊三',
    '男',
    '1935-12-25',
    '13800138035',
    '测试地址3',
    '未知',
    1,
    '联系人3',
    '13900139035',
    NOW(),
    NOW()
  ),
  (
    '特殊四',
    '女',
    '1965-03-08',
    '13800138036',
    '测试地址4',
    '良好',
    1,
    '联系人4',
    '13900139036',
    NOW(),
    NOW()
  ),
  (
    '特殊五',
    '男',
    '1950-08-20',
    '13800138037',
    '测试地址5',
    '1',
    1,
    '联系人5',
    '13900139037',
    NOW(),
    NOW()
  ),
  (
    '特殊六',
    '女',
    '1940-11-12',
    '13800138038',
    '测试地址6',
    '2',
    2,
    '联系人6',
    '13900139038',
    NOW(),
    NOW()
  ),
  (
    '特殊七',
    '男',
    '1930-04-03',
    '13800138039',
    '测试地址7',
    '3',
    3,
    '联系人7',
    '13900139039',
    NOW(),
    NOW()
  );
-- 查询插入结果
SELECT '插入完成，各年龄段健康状态分布如下：' as message;
-- 按年龄段和健康状态统计
SELECT CASE
    WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 60 AND 69 THEN '60-70岁'
    WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 70 AND 79 THEN '70-80岁'
    WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) BETWEEN 80 AND 89 THEN '80-90岁'
    WHEN TIMESTAMPDIFF(YEAR, birth_date, CURDATE()) >= 90 THEN '90岁以上'
    ELSE '其他'
  END as age_range,
  CASE
    WHEN health_status IS NULL THEN '[NULL]'
    WHEN health_status = '' THEN '[EMPTY]'
    ELSE health_status
  END as health_status_display,
  COUNT(*) as count
FROM elderly
WHERE birth_date IS NOT NULL
GROUP BY age_range,
  health_status_display
ORDER BY age_range,
  count DESC;
-- 总体健康状态分布
SELECT CASE
    WHEN health_status IS NULL THEN '[NULL]'
    WHEN health_status = '' THEN '[EMPTY]'
    ELSE health_status
  END as health_status_display,
  COUNT(*) as count,
  ROUND(
    COUNT(*) * 100.0 / (
      SELECT COUNT(*)
      FROM elderly
    ),
    2
  ) as percentage
FROM elderly
GROUP BY health_status_display
ORDER BY count DESC;