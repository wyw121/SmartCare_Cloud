# 📁 .github 文件夹组织规范 - 基于GitHub官方最佳实践

**日期**: 2025-10-28  
**参考文档**: [GitHub Copilot Custom Instructions Official Documentation](https://docs.github.com/en/copilot/customizing-copilot/adding-custom-instructions-for-github-copilot)

## 🎯 问题诊断

### 当前存在的重复文件
你的 `.github` 文件夹中存在两个功能相似但命名不同的文件:

1. ✅ `copilot-instructions.md` - **官方标准命名** (连字符)
2. ❌ `copilot_instructions.md` - **非标准命名** (下划线)

### 官方规定
根据GitHub官方文档，**必须**使用 `copilot-instructions.md` (带连字符 `-`)。

## 📚 GitHub官方 `.github` 文件夹组织标准

### 1️⃣ 仓库级自定义指令 (Repository-wide Custom Instructions)

**文件位置**: `.github/copilot-instructions.md`

**作用范围**: 
- 对整个仓库的所有Copilot请求生效
- 用于Copilot Chat、Copilot编码代理、代码补全等

**内容建议**:
```markdown
# 项目概述
- 项目名称和用途
- 技术栈版本信息
- 主要架构组件

# 构建和验证
- 构建命令 (如: mvn clean install)
- 测试命令 (如: mvn test)
- 运行命令 (如: mvn spring-boot:run)

# 项目结构
- 主要目录说明
- 配置文件位置
- 关键源文件

# 开发规范
- 代码风格
- 命名约定
- 最佳实践

# 依赖关系
- 关键依赖说明
- 非显而易见的依赖关系
```

### 2️⃣ 路径特定指令 (Path-specific Custom Instructions)

**文件位置**: `.github/instructions/*.instructions.md`

**命名格式**: `<NAME>.instructions.md`

**用途**: 针对特定路径或文件类型的定制指令

**示例**:
```markdown
---
applyTo: "backend/**/*.java"
---

所有Java代码必须:
- 使用MyBatis-Plus注解
- 包含完整的Javadoc注释
- 遵循阿里巴巴Java开发规范
```

```markdown
---
applyTo: "frontend/**/*.vue"
---

所有Vue组件必须:
- 使用Composition API
- 使用Element Plus组件
- 遵循Vue 3风格指南
```

### 3️⃣ AI Agent指令文件

**支持的文件**:
- `AGENTS.md` (OpenAI格式，放在任何目录)
- `CLAUDE.md` (Anthropic格式，仅限根目录)
- `GEMINI.md` (Google格式，仅限根目录)

### 4️⃣ 其他标准文件

```
.github/
├── copilot-instructions.md          # ✅ 仓库级Copilot指令 (官方标准)
├── instructions/                     # ✅ 路径特定指令目录
│   ├── backend.instructions.md      # 后端特定指令
│   ├── frontend.instructions.md     # 前端特定指令
│   └── database.instructions.md     # 数据库特定指令
├── workflows/                        # GitHub Actions工作流
│   ├── ci.yml
│   └── deploy.yml
├── ISSUE_TEMPLATE/                   # Issue模板
│   ├── bug_report.md
│   └── feature_request.md
├── PULL_REQUEST_TEMPLATE.md          # PR模板
├── CODEOWNERS                        # 代码所有者
├── FUNDING.yml                       # 赞助配置
└── dependabot.yml                    # 依赖更新配置
```

## 🔧 推荐的文件结构调整

### 当前文件清理建议

基于你的 `.github` 目录内容:

```
当前文件列表:
├── .instructions.md              ❓ 非标准命名
├── .prompt.md                    ❓ 非标准命名
├── copilot-instructions.md       ✅ 保留 (官方标准)
├── copilot_config.md             ❌ 删除或重命名
├── copilot_instructions.md       ❌ 删除 (与官方标准重复)
├── docs/                         ✅ 可选的文档目录
├── prompts/                      ✅ 可选的提示目录
├── README.md                     ✅ .github目录说明
├── setup_summary.md              ✅ 设置摘要
└── workflows/                    ✅ GitHub Actions
```

### 推荐的优化方案

#### 方案A: 最小化标准结构 (推荐)

```
.github/
├── copilot-instructions.md          # 主要Copilot指令 (合并所有内容)
├── instructions/                     # 路径特定指令
│   ├── backend.instructions.md
│   └── frontend.instructions.md
├── workflows/                        # CI/CD工作流
└── README.md                         # .github目录说明
```

#### 方案B: 完整标准结构

```
.github/
├── copilot-instructions.md          # 仓库级Copilot指令
├── instructions/                     # 路径特定指令
│   ├── backend.instructions.md
│   ├── frontend.instructions.md
│   └── database.instructions.md
├── workflows/                        # GitHub Actions
│   ├── ci.yml
│   ├── test.yml
│   └── deploy.yml
├── ISSUE_TEMPLATE/
│   ├── bug_report.md
│   └── feature_request.md
├── PULL_REQUEST_TEMPLATE.md
├── CODEOWNERS
└── README.md
```

## 📝 内容整合建议

### 将多个配置文件整合到官方标准文件

**整合内容到 `copilot-instructions.md`**:

1. **从 `copilot_instructions.md` 迁移内容** (下划线版本)
2. **从 `.instructions.md` 迁移通用指令**
3. **从 `.prompt.md` 迁移提示内容**
4. **从 `copilot_config.md` 迁移配置信息**

**整合后的 `copilot-instructions.md` 结构**:

```markdown
# 智慧医养大数据公共服务平台 - Copilot指令

## 项目概述
- 项目名称、用途、目标用户
- 技术栈详细版本

## 构建和验证
### 后端构建
- cd backend
- mvn clean compile
- mvn spring-boot:run

### 前端构建
- cd frontend
- npm install
- npm run dev

### 测试
- 后端: mvn test
- 前端: npm run test

## 项目结构
[详细的目录结构说明]

## 技术栈
### 后端
- Spring Boot 2.7.18
- MyBatis-Plus 3.5.3.1
- MySQL 8.0.33

### 前端
- Vue 3.4.0
- Element Plus 2.4.4
- Vite 5.0.10

## 开发规范
[代码规范、命名约定、最佳实践]

## 核心业务实体
[业务实体说明]

## 功能模块
[功能模块列表]

## 安全要求
[安全规范和要求]
```

## 🎯 执行步骤

### 步骤1: 备份当前文件

```bash
# 创建备份目录
mkdir .github/.backup_$(Get-Date -Format "yyyy-MM-dd")

# 备份可能要删除的文件
cp .github/copilot_instructions.md .github/.backup_*/
cp .github/copilot_config.md .github/.backup_*/
cp .github/.instructions.md .github/.backup_*/
cp .github/.prompt.md .github/.backup_*/
```

### 步骤2: 整合内容到官方标准文件

1. 审查 `copilot-instructions.md` 当前内容
2. 从其他文件中提取有价值的内容
3. 按照官方建议的结构重新组织
4. 确保内容完整且无重复

### 步骤3: 创建路径特定指令 (可选)

```bash
# 创建instructions目录
mkdir .github/instructions

# 创建后端特定指令
# 文件: .github/instructions/backend.instructions.md
---
applyTo: "backend/**/*.java"
---
[后端开发规范]

# 创建前端特定指令
# 文件: .github/instructions/frontend.instructions.md
---
applyTo: "frontend/**/*.vue,frontend/**/*.js"
---
[前端开发规范]
```

### 步骤4: 删除非标准文件

```bash
# 删除重复和非标准文件
rm .github/copilot_instructions.md    # 下划线版本
rm .github/copilot_config.md          # 非标准配置文件
rm .github/.instructions.md           # 非标准命名
rm .github/.prompt.md                 # 非标准命名
```

### 步骤5: 更新README说明

更新 `.github/README.md` 说明新的文件结构。

## ✅ 验证和测试

### 验证Copilot是否识别

1. 在VS Code中打开Copilot Chat
2. 查看是否显示使用了 `.github/copilot-instructions.md`
3. 在响应的引用(References)中应该看到该文件

### 测试路径特定指令

1. 打开匹配路径的文件
2. 使用Copilot生成代码
3. 验证是否遵循了特定指令

## 📊 官方文档要点

### 指令优先级

1. **个人指令** (最高优先级)
2. **仓库指令** (中等优先级)
3. **组织指令** (最低优先级)

### 指令限制

- **长度限制**: 建议不超过2页
- **格式**: Markdown格式
- **空白**: 指令之间的空白会被忽略
- **不应包含**: 特定任务的指令(应保持通用性)

### 支持的功能

✅ Copilot Chat  
✅ Copilot编码代理(Coding Agent)  
✅ Copilot代码审查(Code Review)  
✅ Copilot代码补全  

## 🎉 总结

**必须保留**: `copilot-instructions.md` (连字符)  
**应该删除**: `copilot_instructions.md` (下划线)  
**建议创建**: `.github/instructions/` 目录用于路径特定指令  
**最佳实践**: 将所有通用指令整合到一个官方标准文件中

---

**参考资源**:
- [GitHub Copilot官方文档](https://docs.github.com/en/copilot/customizing-copilot/adding-custom-instructions-for-github-copilot)
- [自定义指令示例库](https://docs.github.com/en/copilot/tutorials/customization-library/custom-instructions)
- [关于响应定制](https://docs.github.com/en/copilot/concepts/prompting/response-customization)
