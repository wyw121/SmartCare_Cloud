<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWTå¯†é’¥ä¿®å¤åç™»å½•æµ‹è¯• - æ™ºæ…§åŒ»å…»å¹³å°</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        .fix-section {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .fix-section h3 {
            color: #856404;
            margin-top: 0;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }
        .test-section h3 {
            color: #495057;
            margin-top: 0;
        }
        .btn {
            background: #007bff;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background 0.3s;
            margin: 10px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        .btn-warning:hover {
            background: #e0a800;
        }
        .btn-success {
            background: #28a745;
        }
        .btn-success:hover {
            background: #218838;
        }
        .btn-danger {
            background: #dc3545;
        }
        .btn-danger:hover {
            background: #c82333;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #495057;
        }
        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        input[type="text"]:focus, input[type="password"]:focus {
            border-color: #007bff;
            outline: none;
        }
        .quick-accounts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .account-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .account-card:hover {
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .account-card h4 {
            margin: 0 0 10px 0;
            color: #495057;
        }
        .account-card p {
            margin: 5px 0;
            font-size: 14px;
            color: #6c757d;
        }
        .account-card .credentials {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ JWTå¯†é’¥ä¿®å¤åç™»å½•æµ‹è¯•</h1>
        
        <div class="fix-section">
            <h3>âš ï¸ é—®é¢˜è¯´æ˜</h3>
            <p><strong>é—®é¢˜ï¼š</strong>JWTå¯†é’¥ä¿®æ”¹åï¼Œå¼€å‘æ¨¡å¼å¿«é€Ÿç™»å½•è´¦å·å‡ºç°æƒé™éªŒè¯å¤±è´¥é—®é¢˜ã€‚</p>
            <p><strong>åŸå› ï¼š</strong>JWTå¯†é’¥æ”¹å˜å¯¼è‡´ä¹‹å‰ç”Ÿæˆçš„tokenæ— æ³•æ­£ç¡®éªŒè¯ï¼Œéœ€è¦æ¸…é™¤æ—§tokenå¹¶é‡æ–°ç™»å½•ã€‚</p>
            <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ä¸­çš„æ—§tokenï¼Œé‡æ–°è¿›è¡Œç™»å½•éªŒè¯ã€‚</p>
        </div>

        <div class="test-section">
            <h3>1. æ¸…é™¤æ—§çš„è®¤è¯æ•°æ®</h3>
            <p>é¦–å…ˆéœ€è¦æ¸…é™¤æµè§ˆå™¨ä¸­å­˜å‚¨çš„æ—§JWT tokenå’Œç”¨æˆ·ä¿¡æ¯ï¼š</p>
            <button class="btn btn-warning" onclick="clearAuthData()">æ¸…é™¤è®¤è¯æ•°æ®</button>
            <div id="clearResult" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>2. å¿«é€Ÿæµ‹è¯•ç™»å½•</h3>
            <p>é€‰æ‹©ä¸€ä¸ªæµ‹è¯•è´¦å·è¿›è¡Œç™»å½•éªŒè¯ï¼š</p>
            <div class="quick-accounts">
                <div class="account-card" onclick="selectAccount('admin', '123456', 'ç³»ç»Ÿç®¡ç†å‘˜')">
                    <h4>ğŸ›¡ï¸ ç³»ç»Ÿç®¡ç†å‘˜</h4>
                    <p class="credentials">admin / 123456</p>
                    <p>å…¨ç³»ç»Ÿæƒé™</p>
                </div>
                <div class="account-card" onclick="selectAccount('doctor', '123456', 'åŒ»ç”Ÿ')">
                    <h4>ğŸ©º åŒ»ç”Ÿ</h4>
                    <p class="credentials">doctor / 123456</p>
                    <p>åŒ»ç–—ç®¡ç†æƒé™</p>
                </div>
                <div class="account-card" onclick="selectAccount('family', '123456', 'å®¶å±')">
                    <h4>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶å±</h4>
                    <p class="credentials">family / 123456</p>
                    <p>æŸ¥çœ‹æƒé™</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>3. æ‰‹åŠ¨ç™»å½•æµ‹è¯•</h3>
            <div class="form-group">
                <label>ç”¨æˆ·å</label>
                <input type="text" id="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
            </div>
            <div class="form-group">
                <label>å¯†ç </label>
                <input type="password" id="password" placeholder="è¯·è¾“å…¥å¯†ç ">
            </div>
            <button class="btn btn-success" onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
            <button class="btn btn-danger" onclick="testLogout()">æµ‹è¯•ç™»å‡º</button>
            <div id="loginResult" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>4. JWT TokenéªŒè¯</h3>
            <button class="btn" onclick="checkCurrentToken()">æ£€æŸ¥å½“å‰Token</button>
            <button class="btn" onclick="validateToken()">éªŒè¯Token</button>
            <div id="tokenResult" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>5. æƒé™æµ‹è¯•</h3>
            <button class="btn" onclick="testPermissions()">æµ‹è¯•æƒé™</button>
            <button class="btn" onclick="testApiAccess()">æµ‹è¯•APIè®¿é—®</button>
            <div id="permissionResult" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';
        
        // æ¸…é™¤è®¤è¯æ•°æ®
        function clearAuthData() {
            const resultDiv = document.getElementById('clearResult');
            
            try {
                // æ¸…é™¤localStorageä¸­çš„è®¤è¯æ•°æ®
                const keysToRemove = ['token', 'userInfo', 'refreshToken', 'expires'];
                const removedItems = [];
                
                keysToRemove.forEach(key => {
                    if (localStorage.getItem(key)) {
                        localStorage.removeItem(key);
                        removedItems.push(key);
                    }
                });
                
                // æ¸…é™¤sessionStorageä¸­çš„è®¤è¯æ•°æ®
                keysToRemove.forEach(key => {
                    if (sessionStorage.getItem(key)) {
                        sessionStorage.removeItem(key);
                        removedItems.push(key + ' (session)');
                    }
                });
                
                const result = `âœ… è®¤è¯æ•°æ®æ¸…é™¤å®Œæˆï¼

å·²æ¸…é™¤çš„æ•°æ®é¡¹ï¼š
${removedItems.length > 0 ? removedItems.map(item => 'â€¢ ' + item).join('\n') : 'â€¢ æ— éœ€æ¸…é™¤çš„æ•°æ®é¡¹'}

ğŸ“ æ¸…é™¤çŠ¶æ€ï¼š
â€¢ localStorage: ${localStorage.length} é¡¹å‰©ä½™
â€¢ sessionStorage: ${sessionStorage.length} é¡¹å‰©ä½™

ğŸ’¡ å»ºè®®ï¼š
1. å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œè¯·åˆ·æ–°é¡µé¢
2. å¯ä»¥å°è¯•æ¸…é™¤æµè§ˆå™¨æ‰€æœ‰ç¼“å­˜
3. é‡æ–°è¿›è¡Œç™»å½•æµ‹è¯•`;
                
                showResult(resultDiv, result, 'success');
            } catch (error) {
                showResult(resultDiv, `âŒ æ¸…é™¤è®¤è¯æ•°æ®å¤±è´¥ï¼š${error.message}`, 'error');
            }
        }

        // é€‰æ‹©è´¦å·
        function selectAccount(username, password, roleText) {
            document.getElementById('username').value = username;
            document.getElementById('password').value = password;
            
            const resultDiv = document.getElementById('loginResult');
            showResult(resultDiv, `âœ… å·²é€‰æ‹© ${roleText} è´¦å·ï¼š${username}

è¯·ç‚¹å‡»"æµ‹è¯•ç™»å½•"æŒ‰é’®è¿›è¡Œç™»å½•éªŒè¯`, 'info');
        }

        // æµ‹è¯•ç™»å½•
        async function testLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const resultDiv = document.getElementById('loginResult');
            
            if (!username || !password) {
                showResult(resultDiv, 'âŒ è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ', 'error');
                return;
            }
            
            try {
                showResult(resultDiv, 'ğŸ”„ æ­£åœ¨ç™»å½•...', 'info');
                
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const data = await response.json();
                
                if (response.ok && data.code === 200) {
                    const { token, userInfo } = data.data;
                    
                    // å­˜å‚¨æ–°çš„token
                    localStorage.setItem('token', token);
                    localStorage.setItem('userInfo', JSON.stringify(userInfo));
                    
                    showResult(resultDiv, `âœ… ç™»å½•æˆåŠŸï¼

ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯ï¼š
â€¢ ç”¨æˆ·åï¼š${userInfo.username}
â€¢ çœŸå®å§“åï¼š${userInfo.name || userInfo.realName}
â€¢ è§’è‰²ï¼š${userInfo.roleCode} (${userInfo.roleName})
â€¢ éƒ¨é—¨ï¼š${userInfo.department || 'æ— '}

ğŸ” JWTä¿¡æ¯ï¼š
â€¢ Tokenç±»å‹ï¼šBearer
â€¢ è¿‡æœŸæ—¶é—´ï¼š${new Date(Date.now() + 7200 * 1000).toLocaleString()}
â€¢ Tokené•¿åº¦ï¼š${token.length}å­—ç¬¦

âœ… ä¿®å¤çŠ¶æ€ï¼šJWTå¯†é’¥å®‰å…¨æ€§é—®é¢˜å·²è§£å†³ï¼Œç™»å½•åŠŸèƒ½æ­£å¸¸ï¼`, 'success');
                } else {
                    showResult(resultDiv, `âŒ ç™»å½•å¤±è´¥ï¼š${data.message || 'æœªçŸ¥é”™è¯¯'}

è¯·æ£€æŸ¥ï¼š
1. ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
2. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸`, 'error');
                }
            } catch (error) {
                showResult(resultDiv, `âŒ ç½‘ç»œé”™è¯¯ï¼š${error.message}

è¯·æ£€æŸ¥ï¼š
1. åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨ (http://localhost:8080)
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. è·¨åŸŸé…ç½®æ˜¯å¦æ­£ç¡®`, 'error');
            }
        }

        // æµ‹è¯•ç™»å‡º
        function testLogout() {
            const resultDiv = document.getElementById('loginResult');
            
            try {
                localStorage.removeItem('token');
                localStorage.removeItem('userInfo');
                sessionStorage.removeItem('token');
                sessionStorage.removeItem('userInfo');
                
                showResult(resultDiv, `âœ… ç™»å‡ºæˆåŠŸï¼

å·²æ¸…é™¤çš„æ•°æ®ï¼š
â€¢ JWT Token
â€¢ ç”¨æˆ·ä¿¡æ¯
â€¢ ä¼šè¯æ•°æ®

ğŸ’¡ æç¤ºï¼šç°åœ¨å¯ä»¥é‡æ–°ç™»å½•æµ‹è¯•`, 'success');
            } catch (error) {
                showResult(resultDiv, `âŒ ç™»å‡ºå¤±è´¥ï¼š${error.message}`, 'error');
            }
        }

        // æ£€æŸ¥å½“å‰Token
        function checkCurrentToken() {
            const resultDiv = document.getElementById('tokenResult');
            
            const token = localStorage.getItem('token');
            const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');
            
            if (!token) {
                showResult(resultDiv, `âŒ æœªæ‰¾åˆ°JWT Token

çŠ¶æ€ï¼šæœªç™»å½•
å»ºè®®ï¼šè¯·å…ˆè¿›è¡Œç™»å½•`, 'warning');
                return;
            }
            
            try {
                // è§£æJWT Token
                const parts = token.split('.');
                if (parts.length === 3) {
                    const header = JSON.parse(atob(parts[0]));
                    const payload = JSON.parse(atob(parts[1]));
                    
                    const result = `âœ… JWT Tokenä¿¡æ¯ï¼š

ğŸ“‹ Tokenç»“æ„ï¼š
â€¢ Header: ${JSON.stringify(header, null, 2)}
â€¢ Payload: ${JSON.stringify(payload, null, 2)}
â€¢ ç­¾å: ${parts[2].substring(0, 20)}...

â° æ—¶é—´ä¿¡æ¯ï¼š
â€¢ ç­¾å‘æ—¶é—´: ${new Date(payload.iat * 1000).toLocaleString()}
â€¢ è¿‡æœŸæ—¶é—´: ${new Date(payload.exp * 1000).toLocaleString()}
â€¢ å‰©ä½™æ—¶é—´: ${Math.max(0, Math.floor((payload.exp * 1000 - Date.now()) / 1000))}ç§’

ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯ï¼š
â€¢ ç”¨æˆ·ID: ${payload.userId}
â€¢ ç”¨æˆ·å: ${payload.sub}
â€¢ è§’è‰²: ${payload.roleCode}

ğŸ” å®‰å…¨ä¿¡æ¯ï¼š
â€¢ ç®—æ³•: ${header.alg}
â€¢ å¯†é’¥é•¿åº¦: 95å­—èŠ‚ (760ä½)
â€¢ ç¬¦åˆæ ‡å‡†: âœ… RFC 7518`;
                    
                    showResult(resultDiv, result, 'success');
                } else {
                    showResult(resultDiv, `âŒ Tokenæ ¼å¼é”™è¯¯ï¼šä¸æ˜¯æœ‰æ•ˆçš„JWTæ ¼å¼`, 'error');
                }
            } catch (error) {
                showResult(resultDiv, `âŒ Tokenè§£æå¤±è´¥ï¼š${error.message}`, 'error');
            }
        }

        // éªŒè¯Token
        async function validateToken() {
            const resultDiv = document.getElementById('tokenResult');
            const token = localStorage.getItem('token');
            
            if (!token) {
                showResult(resultDiv, 'âŒ æœªæ‰¾åˆ°JWT Tokenï¼Œè¯·å…ˆç™»å½•', 'error');
                return;
            }
            
            try {
                showResult(resultDiv, 'ğŸ”„ æ­£åœ¨éªŒè¯Token...', 'info');
                
                const response = await fetch(`${API_BASE}/api/auth/validate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const data = await response.json();
                
                if (response.ok && data.code === 200) {
                    showResult(resultDiv, `âœ… TokenéªŒè¯æˆåŠŸï¼

éªŒè¯ç»“æœï¼š${JSON.stringify(data.data, null, 2)}

ğŸ” éªŒè¯é€šè¿‡é¡¹ï¼š
â€¢ å¯†é’¥éªŒè¯ï¼šâœ… é€šè¿‡
â€¢ ç­¾åéªŒè¯ï¼šâœ… é€šè¿‡  
â€¢ æ—¶é—´éªŒè¯ï¼šâœ… é€šè¿‡
â€¢ æ ¼å¼éªŒè¯ï¼šâœ… é€šè¿‡

âœ… ä¿®å¤ç¡®è®¤ï¼šJWTå¯†é’¥å®‰å…¨æ€§é—®é¢˜å·²å®Œå…¨è§£å†³ï¼`, 'success');
                } else {
                    showResult(resultDiv, `âŒ TokenéªŒè¯å¤±è´¥ï¼š${data.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
                }
            } catch (error) {
                showResult(resultDiv, `âŒ éªŒè¯è¯·æ±‚å¤±è´¥ï¼š${error.message}`, 'error');
            }
        }

        // æµ‹è¯•æƒé™
        function testPermissions() {
            const resultDiv = document.getElementById('permissionResult');
            const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');
            
            if (!userInfo.username) {
                showResult(resultDiv, 'âŒ æœªæ‰¾åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œè¯·å…ˆç™»å½•', 'error');
                return;
            }
            
            const permissions = userInfo.permissions || [];
            const role = userInfo.role || userInfo.roleCode;
            
            const result = `âœ… æƒé™æ£€æŸ¥ç»“æœï¼š

ğŸ‘¤ å½“å‰ç”¨æˆ·ï¼š${userInfo.username} (${userInfo.name || userInfo.realName})
ğŸ·ï¸ ç”¨æˆ·è§’è‰²ï¼š${role}

ğŸ”‘ æƒé™åˆ—è¡¨ï¼š
${permissions.length > 0 ? permissions.map(p => 'â€¢ ' + p).join('\n') : 'â€¢ æ— ç‰¹å®šæƒé™'}

ğŸ“Š æƒé™åˆ†æï¼š
â€¢ æ˜¯å¦ç®¡ç†å‘˜ï¼š${role === 'admin' ? 'âœ… æ˜¯' : 'âŒ å¦'}
â€¢ æ˜¯å¦åŒ»ç”Ÿï¼š${role === 'doctor' ? 'âœ… æ˜¯' : 'âŒ å¦'}
â€¢ æ˜¯å¦å®¶å±ï¼š${role === 'family' ? 'âœ… æ˜¯' : 'âŒ å¦'}
â€¢ å…¨éƒ¨æƒé™ï¼š${permissions.includes('*') ? 'âœ… æ‹¥æœ‰' : 'âŒ æ²¡æœ‰'}

ğŸ’¡ æƒé™çŠ¶æ€ï¼šæ­£å¸¸ï¼Œå¯ä»¥è®¿é—®å¯¹åº”çš„åŠŸèƒ½æ¨¡å—`;
            
            showResult(resultDiv, result, 'success');
        }

        // æµ‹è¯•APIè®¿é—®
        async function testApiAccess() {
            const resultDiv = document.getElementById('permissionResult');
            const token = localStorage.getItem('token');
            
            if (!token) {
                showResult(resultDiv, 'âŒ æœªæ‰¾åˆ°JWT Tokenï¼Œè¯·å…ˆç™»å½•', 'error');
                return;
            }
            
            showResult(resultDiv, 'ğŸ”„ æ­£åœ¨æµ‹è¯•APIè®¿é—®...', 'info');
            
            const testAPIs = [
                { name: 'å¥åº·é¢„è­¦åˆ—è¡¨', url: '/api/health-warning/list', method: 'GET' },
                { name: 'ç”¨æˆ·ä¿¡æ¯', url: '/api/user/info', method: 'GET' },
                { name: 'è€äººåˆ—è¡¨', url: '/api/elderly/list', method: 'GET' }
            ];
            
            const results = [];
            
            for (const api of testAPIs) {
                try {
                    const response = await fetch(`${API_BASE}${api.url}`, {
                        method: api.method,
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    const data = await response.json();
                    results.push(`â€¢ ${api.name}: ${response.ok ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'} (${response.status})`);
                } catch (error) {
                    results.push(`â€¢ ${api.name}: âŒ é”™è¯¯ (${error.message})`);
                }
            }
            
            const result = `ğŸ“Š APIè®¿é—®æµ‹è¯•ç»“æœï¼š

${results.join('\n')}

ğŸ’¡ æµ‹è¯•è¯´æ˜ï¼š
â€¢ âœ… æˆåŠŸï¼šAPIæ­£å¸¸å“åº”ï¼Œæƒé™éªŒè¯é€šè¿‡
â€¢ âŒ å¤±è´¥ï¼šå¯èƒ½æ˜¯æƒé™ä¸è¶³æˆ–APIé”™è¯¯
â€¢ âŒ é”™è¯¯ï¼šç½‘ç»œæˆ–æœåŠ¡å™¨é”™è¯¯

ğŸ” å¦‚æœå‡ºç°å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š
1. JWT Tokenæ˜¯å¦æœ‰æ•ˆ
2. ç”¨æˆ·è§’è‰²æƒé™æ˜¯å¦è¶³å¤Ÿ
3. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸
4. å®‰å…¨é…ç½®æ˜¯å¦æ­£ç¡®`;
            
            showResult(resultDiv, result, 'info');
        }

        // æ˜¾ç¤ºç»“æœ
        function showResult(element, message, type) {
            element.style.display = 'block';
            element.className = `result ${type}`;
            element.textContent = message;
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥çŠ¶æ€
        window.onload = function() {
            const resultDiv = document.getElementById('clearResult');
            const token = localStorage.getItem('token');
            const userInfo = localStorage.getItem('userInfo');
            
            if (token || userInfo) {
                showResult(resultDiv, `âš ï¸ æ£€æµ‹åˆ°å·²å­˜åœ¨çš„è®¤è¯æ•°æ®

å½“å‰çŠ¶æ€ï¼š
â€¢ Token: ${token ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}
â€¢ ç”¨æˆ·ä¿¡æ¯: ${userInfo ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}

ğŸ’¡ å»ºè®®ï¼š
å¦‚æœé‡åˆ°æƒé™é—®é¢˜ï¼Œè¯·ç‚¹å‡»"æ¸…é™¤è®¤è¯æ•°æ®"æŒ‰é’®ï¼Œç„¶åé‡æ–°ç™»å½•`, 'warning');
            } else {
                showResult(resultDiv, `âœ… è®¤è¯æ•°æ®çŠ¶æ€è‰¯å¥½

å½“å‰çŠ¶æ€ï¼šæ— æ®‹ç•™çš„è®¤è¯æ•°æ®
å¯ä»¥ç›´æ¥è¿›è¡Œç™»å½•æµ‹è¯•`, 'info');
            }
        };
    </script>
</body>
</html>
