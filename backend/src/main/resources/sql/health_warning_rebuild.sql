-- 重新创建健康预警表
DROP TABLE IF EXISTS `t_health_warning`;
CREATE TABLE `t_health_warning` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `elderly_id` BIGINT(20) NOT NULL COMMENT '老人ID',
  `elderly_name` VARCHAR(50) NOT NULL COMMENT '老人姓名',
  `warning_type` VARCHAR(30) NOT NULL COMMENT '预警类型',
  `warning_level` INT(1) NOT NULL COMMENT '预警级别 (1-低风险, 2-中风险, 3-高风险, 4-紧急)',
  `title` VARCHAR(200) NOT NULL COMMENT '预警标题',
  `content` TEXT NOT NULL COMMENT '预警内容',
  `trigger_data` VARCHAR(255) NULL COMMENT '触发数据',
  `data_source` VARCHAR(50) NULL COMMENT '数据来源',
  `trigger_time` DATETIME NOT NULL COMMENT '触发时间',
  `status` INT(1) NOT NULL DEFAULT 0 COMMENT '处理状态 (0-未处理, 1-已查看, 2-处理中, 3-已处理, 4-已忽略)',
  `handler_id` BIGINT(20) NULL COMMENT '处理人ID',
  `handler_name` VARCHAR(50) NULL COMMENT '处理人姓名',
  `handle_time` DATETIME NULL COMMENT '处理时间',
  `handle_remark` TEXT NULL COMMENT '处理备注',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `create_by` VARCHAR(50) NULL COMMENT '创建者',
  `update_by` VARCHAR(50) NULL COMMENT '更新者',
  `is_deleted` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否删除 (1-已删除, 0-未删除)',
  PRIMARY KEY (`id`),
  KEY `idx_elderly_id` (`elderly_id`),
  KEY `idx_warning_type` (`warning_type`),
  KEY `idx_warning_level` (`warning_level`),
  KEY `idx_trigger_time` (`trigger_time`),
  KEY `idx_status` (`status`)
) ENGINE = InnoDB AUTO_INCREMENT = 1000 DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '健康预警表';
-- 清空表数据（如果需要）
TRUNCATE TABLE `t_health_warning`;
-- 插入中文测试数据
INSERT INTO `t_health_warning` (
    `elderly_id`,
    `elderly_name`,
    `warning_type`,
    `warning_level`,
    `title`,
    `content`,
    `trigger_data`,
    `data_source`,
    `trigger_time`,
    `status`,
    `handler_id`,
    `handler_name`,
    `handle_time`,
    `handle_remark`
  )
VALUES -- 紧急预警数据
  (
    1001,
    '张志明',
    '血压异常',
    4,
    '血压严重偏高',
    '老人血压测量值达到180/110mmHg，远高于正常范围，存在高血压危象风险，需立即干预！',
    '180/110mmHg（正常范围：90-140/60-90mmHg）',
    '智能血压计',
    '2025-07-03 08:12:32',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1002,
    '李秀英',
    '心率异常',
    4,
    '心率过速伴心律不齐',
    '老人心率持续超过120次/分钟，并伴有心律不齐，疑似心脏问题，请立即就医！',
    '心率128次/分钟，不规则（正常范围：60-100次/分钟）',
    '智能手环',
    '2025-07-03 09:35:17',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1003,
    '王建国',
    '体温异常',
    4,
    '高热不退',
    '老人体温持续39.8℃，已超过24小时，有脱水风险，需立即医疗介入！',
    '体温39.8℃（正常范围：36-37.2℃）',
    '智能体温计',
    '2025-07-02 21:45:08',
    1,
    2001,
    '张医生',
    '2025-07-03 07:05:23',
    NULL
  ),
  (
    1004,
    '赵丽华',
    '跌倒风险',
    4,
    '检测到跌倒',
    '系统检测到老人在卧室发生跌倒，可能存在身体伤害，需立即确认并处理！',
    '加速度传感器检测到突然变化',
    '智能地垫',
    '2025-07-03 05:22:41',
    2,
    2002,
    '李护士',
    '2025-07-03 05:25:12',
    '已电话联系老人家属，家属已到达现场，老人右膝擦伤，无骨折'
  ),
  (
    1005,
    '陈国强',
    '长期不活动',
    4,
    '长时间未检测到活动',
    '系统连续12小时未检测到老人活动信号，可能存在意外风险，请立即查看！',
    '自昨日19:00至今无活动信号',
    '动作传感器',
    '2025-07-03 07:11:09',
    3,
    2003,
    '王主任',
    '2025-07-03 07:30:18',
    '入户查看，老人出门忘记携带设备，已联系确认安全'
  ),
  -- 高风险预警数据
  (
    1006,
    '钱文琴',
    '血糖异常',
    3,
    '空腹血糖偏高',
    '老人空腹血糖值达到11.2mmol/L，明显高于正常范围，需要及时调整用药或就医！',
    '11.2mmol/L（正常范围：3.9-6.1mmol/L）',
    '智能血糖仪',
    '2025-07-02 07:23:56',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1007,
    '周志强',
    '血压异常',
    3,
    '血压持续偏高',
    '老人连续3天血压测量均在160/100mmHg以上，存在中风风险，需要调整降压方案！',
    '165/105mmHg（正常范围：90-140/60-90mmHg）',
    '智能血压计',
    '2025-07-03 10:15:27',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1008,
    '吴淑芬',
    '药物未按时服用',
    3,
    '连续两天未服用降压药',
    '系统检测到老人连续两天未按时服用降压药物，可能导致血压控制不良！',
    '最近服药时间：2025-07-01 08:00',
    '智能药盒',
    '2025-07-03 08:05:12',
    1,
    2004,
    '刘护士',
    '2025-07-03 08:30:45',
    NULL
  ),
  (
    1009,
    '郑建华',
    '心率异常',
    3,
    '心率持续过缓',
    '老人静息心率持续低于50次/分钟，可能与心脏传导问题有关，需要进一步评估！',
    '心率48次/分钟（正常范围：60-100次/分钟）',
    '智能手表',
    '2025-07-02 22:34:19',
    2,
    2005,
    '张医生',
    '2025-07-03 09:12:33',
    '已电话随访，正在服用β受体阻滞剂，心率过缓与用药有关，已建议调整用药'
  ),
  (
    1010,
    '马丽娟',
    '体温异常',
    3,
    '持续低热',
    '老人体温连续12小时在37.5-38.2℃之间波动，伴有轻微咳嗽症状，需关注！',
    '体温37.8℃（正常范围：36-37.2℃）',
    '智能体温计',
    '2025-07-03 04:56:32',
    3,
    2006,
    '李医生',
    '2025-07-03 10:23:17',
    '入户随访，疑似上呼吸道感染，已开具药物治疗方案'
  ),
  -- 中风险预警数据
  (
    1011,
    '林明华',
    '血压异常',
    2,
    '血压轻度偏高',
    '老人血压测量为150/95mmHg，高于正常范围，但未达到高危水平，建议定期监测！',
    '150/95mmHg（正常范围：90-140/60-90mmHg）',
    '智能血压计',
    '2025-07-03 07:47:33',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1012,
    '黄秀兰',
    '血糖异常',
    2,
    '餐后血糖偏高',
    '老人餐后2小时血糖为10.5mmol/L，高于正常范围，需关注饮食控制！',
    '10.5mmol/L（正常范围：<7.8mmol/L）',
    '智能血糖仪',
    '2025-07-02 14:22:18',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1013,
    '徐国强',
    '药物未按时服用',
    2,
    '降糖药服用时间延迟',
    '老人今日降糖药服用时间延迟超过3小时，可能影响血糖控制！',
    '应服用时间：07:30，实际服用时间：10:45',
    '智能药盒',
    '2025-07-03 10:45:37',
    1,
    2007,
    '张护士',
    '2025-07-03 11:05:22',
    NULL
  ),
  (
    1014,
    '孙丽娜',
    '心率异常',
    2,
    '轻度心动过速',
    '老人静息心率为105次/分钟，轻度偏快，如伴有胸闷等症状需进一步评估！',
    '心率105次/分钟（正常范围：60-100次/分钟）',
    '智能手环',
    '2025-07-02 18:33:25',
    2,
    2008,
    '王护士',
    '2025-07-03 08:45:19',
    '已电话随访，老人否认不适症状，建议注意休息，减少咖啡因摄入'
  ),
  (
    1015,
    '胡建军',
    '长期不活动',
    2,
    '活动量明显减少',
    '系统检测到老人近3天活动量较平时减少50%，可能存在身体不适或情绪问题！',
    '日均步数从6000步降至3000步',
    '智能手环',
    '2025-07-03 00:05:12',
    3,
    2009,
    '刘社工',
    '2025-07-03 10:15:43',
    '入户随访，老人近日膝关节疼痛加重，已安排理疗师上门服务'
  ),
  -- 低风险预警数据
  (
    1016,
    '朱小红',
    '血压异常',
    1,
    '血压轻微波动',
    '老人血压测量为145/90mmHg，略高于理想范围，建议继续监测！',
    '145/90mmHg（正常范围：90-140/60-90mmHg）',
    '智能血压计',
    '2025-07-03 06:23:45',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1017,
    '杨文静',
    '体温异常',
    1,
    '体温轻微升高',
    '老人体温为37.3℃，略高于正常范围，无其他不适症状，建议观察！',
    '体温37.3℃（正常范围：36-37.2℃）',
    '智能体温计',
    '2025-07-02 20:17:33',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1018,
    '冯志刚',
    '血糖异常',
    1,
    '餐前血糖轻微偏低',
    '老人餐前血糖为3.8mmol/L，接近低血糖范围，建议适当增加碳水化合物摄入！',
    '3.8mmol/L（正常范围：3.9-6.1mmol/L）',
    '智能血糖仪',
    '2025-07-03 11:45:29',
    1,
    2010,
    '李护士',
    '2025-07-03 12:05:17',
    NULL
  ),
  (
    1019,
    '唐丽丽',
    '药物未按时服用',
    1,
    '钙片服用时间提醒',
    '老人今日尚未服用钙片补充剂，请提醒按时服用！',
    '应服用时间：08:00，目前未服用',
    '智能药盒',
    '2025-07-03 11:00:34',
    4,
    2011,
    '张护士',
    '2025-07-03 11:30:26',
    '老人主动选择暂停服用钙片，因计划当日检验血钙水平'
  ),
  (
    1020,
    '贾明亮',
    '心率异常',
    1,
    '心率略高',
    '老人清晨心率为102次/分钟，略高于正常范围上限，如无不适可继续观察！',
    '心率102次/分钟（正常范围：60-100次/分钟）',
    '智能手表',
    '2025-07-03 06:34:18',
    3,
    2012,
    '王医生',
    '2025-07-03 09:45:32',
    '已电话随访，老人感觉良好，可能与晨起活动有关，无需特殊处理'
  ),
  -- 更多类型的健康预警数据
  -- 紧急预警
  (
    1021,
    '谢东风',
    '血氧异常',
    4,
    '血氧饱和度严重降低',
    '老人血氧饱和度降至85%，显著低于正常水平，存在组织缺氧风险，需紧急医疗干预！',
    '血氧饱和度85%（正常范围：95-100%）',
    '智能血氧仪',
    '2025-07-03 11:23:45',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1022,
    '刘大勇',
    '呼吸异常',
    4,
    '严重呼吸急促',
    '老人呼吸频率达到30次/分钟，伴有明显呼吸困难，可能为呼吸系统疾病急性发作！',
    '呼吸频率30次/分钟（正常范围：12-20次/分钟）',
    '智能监测设备',
    '2025-07-03 12:05:17',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  -- 高风险预警
  (
    1023,
    '何淑芳',
    '饮食异常',
    3,
    '连续两天进食量严重不足',
    '老人连续两天食物摄入量不足正常的30%，存在营养不良风险，需关注！',
    '每日热量摄入约500大卡（推荐摄入：1800大卡）',
    '智能餐盘',
    '2025-07-03 07:30:22',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1024,
    '邓光明',
    '睡眠异常',
    3,
    '严重睡眠障碍',
    '老人连续一周睡眠时间每晚少于4小时，并有频繁醒来记录，可能影响身心健康！',
    '夜间睡眠3.5小时，醒来7次',
    '智能床垫',
    '2025-07-02 08:12:35',
    1,
    2013,
    '张心理医生',
    '2025-07-03 09:30:18',
    NULL
  ),
  -- 中风险预警
  (
    1025,
    '罗文静',
    '排便异常',
    2,
    '连续三天未排便',
    '系统记录到老人已连续三天未排便，可能存在便秘问题，建议增加膳食纤维摄入！',
    '上次排便时间：2025-07-01 07:30',
    '智能马桶',
    '2025-07-03 08:00:25',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1026,
    '韩晓峰',
    '体重异常',
    2,
    '一周内体重下降显著',
    '老人一周内体重下降3.5公斤，超过体重的5%，需关注是否存在健康问题！',
    '体重从70公斤降至66.5公斤',
    '智能体重秤',
    '2025-07-03 06:45:33',
    2,
    2014,
    '刘医生',
    '2025-07-03 10:15:27',
    '已预约上门随访，排查潜在健康问题'
  ),
  -- 低风险预警
  (
    1027,
    '许雪梅',
    '情绪异常',
    1,
    '情绪波动增加',
    '系统检测到老人一周内消极情绪表达增加，社交活动减少，建议心理关注！',
    '笑容次数减少40%，社交互动减少30%',
    '情绪识别系统',
    '2025-07-02 14:23:19',
    0,
    NULL,
    NULL,
    NULL,
    NULL
  ),
  (
    1028,
    '梁建国',
    '康复训练异常',
    1,
    '康复训练完成率下降',
    '老人本周康复训练完成率仅为60%，低于既定目标，建议了解原因并鼓励参与！',
    '本周训练6次，完成3.6次',
    '智能康复设备',
    '2025-07-03 09:17:28',
    4,
    2015,
    '王康复师',
    '2025-07-03 10:30:45',
    '老人反映训练强度过大，已调整训练计划'
  );