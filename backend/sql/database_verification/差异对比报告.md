# 数据库实际结构与文档差异对比报告

**验证时间:** 2025-10-29  
**验证结果:** 16/18表存在,2个设备管理表缺失  

---

## 🔴 发现的主要问题

### 1. family_user 表结构不匹配

**文档定义(18字段):** 包含 elderly_id, relationship, is_primary, is_emergency 等
**实际结构(12字段):** 
```
id, sys_user_id, real_name, gender, phone, email, status,
is_deleted, create_time, update_time, create_by, update_by
```

**问题:**
- ❌ 文档定义的 `user_id` 实际为 `sys_user_id`
- ❌ 缺少 `elderly_id` (未关联老人)
- ❌ 缺少 `relationship` (关系类型)
- ❌ 缺少 `is_primary`, `is_emergency` 字段
- ❌ 字段名不统一: `create_time` vs `created_time`

---

### 2. elderly_care_assessment 表结构不匹配

**文档定义(18字段):** 包含详细评分字段
**实际结构(12字段):**
```
id, elderly_id, assessment_date, assessment_type, total_score,
risk_level, assessment_result, suggestions, assessor_name,
create_time, update_time, is_deleted
```

**问题:**
- ❌ 缺少 `assessor_id` 字段
- ❌ 缺少详细评分字段: self_care_score, mobility_score, cognitive_score, communication_score
- ❌ 缺少 `care_level` (建议照护等级)
- ❌ 缺少 `care_suggestions` 字段
- ❌ `assessment_result` 实际存在但文档写的是 `assessment_details`

---

### 3. 设备管理表缺失

**文档定义:** equipment, equipment_usage_record
**实际状态:** ❌ 两个表都不存在于数据库中

---

### 4. 字段命名不一致问题

**时间戳字段:**
- 部分表使用: `create_time`, `update_time`
- 文档某些地方写: `created_time`, `updated_time`

**实际情况检查:**
- sys_user: `created_time`, `updated_time` ✅
- family_user: `create_time`, `update_time` ❌
- elderly_care_assessment: `create_time`, `update_time` ❌

---

## 📋 需要更新的文档部分

### 优先级 🔴 高 - 立即修正

1. **family_user 表定义** - 使用实际的12字段结构
2. **elderly_care_assessment 表定义** - 使用实际的12字段结构
3. **删除设备管理表** - equipment相关表暂不存在

### 优先级 🟡 中 - 后续完善

4. 验证其他14个表的字段细节
5. 统一字段命名规范说明

---

## ✅ 建议的修正策略

### 策略选择
**采用策略B:** 更新文档以匹配实际数据库

**理由:**
1. 避免修改已有生产数据
2. 保证文档真实可靠
3. 后端代码已基于当前数据库结构开发

---

## 📝 下一步行动

1. ✅ 修正 `family_user` 表文档定义
2. ✅ 修正 `elderly_care_assessment` 表文档定义  
3. ✅ 从文档中删除不存在的设备管理表(或标注为待开发)
4. ⏳ 逐个验证剩余14个表的字段详情
5. ⏳ 统一字段命名说明

