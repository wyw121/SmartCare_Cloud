# 智慧医养平台开发指导

## 项目背景
您正在开发一个智慧医养大数据公共服务平台的云端后台管理系统。这个系统是为了解决老龄化社会中老年人医疗和养老服务的数字化管理需求。

## 核心目标
- 建立完整的老人健康档案管理体系
- 实现健康数据的实时监控和预警
- 提供数据驱动的决策支持
- 优化医养资源配置和服务效率

## 技术架构提示
在编写代码时，请始终考虑：

### 后端架构 (Spring Boot + MyBatis)
```
建议的包结构：
src/main/java/com/smartcare/cloud/
├── SmartCareCloudApplication.java (启动类)
├── config/ (配置类)
│   ├── WebMvcConfig.java
│   ├── MyBatisConfig.java
│   ├── SecurityConfig.java
│   └── RedisConfig.java
├── controller/ (控制器层)
│   ├── ElderlyController.java
│   ├── HealthWarningController.java
│   ├── ReportController.java
│   └── UserController.java
├── service/ (业务逻辑层)
│   ├── ElderlyService.java
│   ├── HealthWarningService.java
│   └── ReportService.java
├── mapper/ (数据访问层)
├── entity/ (数据库实体)
├── dto/ (数据传输对象)
├── vo/ (视图对象)
├── utils/ (工具类)
└── exception/ (异常处理)
```

### 前端架构 (Vue.js)
```
建议的目录结构：
src/
├── main.js (入口文件)
├── router/ (路由配置)
├── store/ (Pinia状态管理)
├── views/ (页面组件)
│   ├── Dashboard/ (首页)
│   ├── Elderly/ (老人档案)
│   ├── HealthWarning/ (健康预警)
│   ├── Assessment/ (评估报告)
│   ├── Reports/ (报表统计)
│   ├── Equipment/ (设备管理)
│   ├── Users/ (用户管理)
│   └── Profile/ (个人中心)
├── components/ (公共组件)
├── api/ (API接口)
├── utils/ (工具函数)
└── assets/ (静态资源)
```

## 业务逻辑重点

### 老人档案管理
- 基础信息：姓名、年龄、性别、身份证号、联系方式
- 健康信息：病史、过敏史、用药记录、体检数据
- 家庭信息：紧急联系人、家庭地址、经济状况
- 服务信息：入住时间、护理级别、主治医生

### 健康预警系统
- 生命体征监控：血压、心率、血糖、体温
- 异常阈值设定：个性化的预警参数
- 预警级别：一般、重要、紧急
- 处理流程：预警触发→通知相关人员→处理记录

### 数据安全要求
- 个人隐私保护：数据脱敏、访问控制
- 权限管理：角色基础的访问控制(RBAC)
- 审计日志：操作记录和数据变更追踪
- 数据备份：定期备份和灾难恢复

## 编码规范

### Java后端规范
```java
// 控制器示例
@RestController
@RequestMapping("/api/elderly")
@Api(tags = "老人档案管理")
public class ElderlyController {
    
    @Autowired
    private ElderlyService elderlyService;
    
    @GetMapping("/{id}")
    @ApiOperation("获取老人详细信息")
    public ResponseResult<ElderlyDetailVO> getElderlyDetail(@PathVariable Long id) {
        // 实现逻辑
    }
}

// 服务层示例
@Service
@Transactional
public class ElderlyServiceImpl implements ElderlyService {
    
    @Autowired
    private ElderlyMapper elderlyMapper;
    
    @Override
    public ElderlyDetailVO getElderlyDetail(Long id) {
        // 业务逻辑实现
    }
}
```

### Vue前端规范
```vue
<template>
  <div class="elderly-profile">
    <el-card class="profile-card">
      <template #header>
        <div class="card-header">
          <span>老人档案</span>
          <el-button type="primary" @click="editProfile">编辑</el-button>
        </div>
      </template>
      <!-- 内容区域 -->
    </el-card>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { elderlyApi } from '@/api/elderly'

// 组件逻辑
</script>

<style scoped>
.elderly-profile {
  /* 样式定义 */
}
</style>
```

## 数据库设计指导

### 核心表结构建议
```sql
-- 老人基础信息表
CREATE TABLE elderly_basic_info (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL COMMENT '姓名',
    gender TINYINT COMMENT '性别：1男，2女',
    birth_date DATE COMMENT '出生日期',
    id_card VARCHAR(18) COMMENT '身份证号',
    phone VARCHAR(20) COMMENT '联系电话',
    address TEXT COMMENT '家庭地址',
    emergency_contact VARCHAR(50) COMMENT '紧急联系人',
    emergency_phone VARCHAR(20) COMMENT '紧急联系电话',
    care_level TINYINT COMMENT '护理级别',
    status TINYINT DEFAULT 1 COMMENT '状态：1正常，0停用',
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 健康档案表
CREATE TABLE elderly_health_records (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    elderly_id BIGINT NOT NULL COMMENT '老人ID',
    record_type TINYINT COMMENT '记录类型：1体检，2日常监测，3就医',
    record_date DATETIME COMMENT '记录时间',
    blood_pressure VARCHAR(20) COMMENT '血压',
    heart_rate INT COMMENT '心率',
    blood_sugar DECIMAL(5,2) COMMENT '血糖',
    temperature DECIMAL(4,2) COMMENT '体温',
    notes TEXT COMMENT '备注',
    doctor_id BIGINT COMMENT '记录医生',
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 健康预警表
CREATE TABLE health_warnings (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    elderly_id BIGINT NOT NULL COMMENT '老人ID',
    warning_type TINYINT COMMENT '预警类型',
    warning_level TINYINT COMMENT '预警级别：1轻微，2中度，3严重',
    warning_content TEXT COMMENT '预警内容',
    trigger_value VARCHAR(100) COMMENT '触发值',
    threshold_value VARCHAR(100) COMMENT '阈值',
    status TINYINT DEFAULT 1 COMMENT '处理状态：1待处理，2处理中，3已处理',
    handled_by BIGINT COMMENT '处理人',
    handled_time DATETIME COMMENT '处理时间',
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## API接口设计模式

### 统一响应格式
```java
public class ResponseResult<T> {
    private Integer code;
    private String message;
    private T data;
    private Long timestamp;
    
    // 构造方法和getter/setter
}
```

### 分页查询格式
```java
public class PageResult<T> {
    private Long total;
    private Integer page;
    private Integer size;
    private List<T> records;
    
    // 构造方法和getter/setter
}
```

## 关键功能实现提示

### 健康预警算法
```java
@Component
public class HealthWarningEngine {
    
    /**
     * 检查健康指标是否异常
     */
    public List<HealthWarning> checkHealthIndicators(Long elderlyId, HealthRecord record) {
        List<HealthWarning> warnings = new ArrayList<>();
        
        // 血压检查
        if (isBloodPressureAbnormal(record.getBloodPressure())) {
            warnings.add(createWarning(elderlyId, WarningType.BLOOD_PRESSURE, record));
        }
        
        // 其他指标检查...
        
        return warnings;
    }
}
```

### 数据统计分析
```java
@Service
public class ReportService {
    
    /**
     * 生成健康趋势报告
     */
    public HealthTrendReport generateHealthTrendReport(Long elderlyId, DateRange dateRange) {
        // 获取时间段内的健康数据
        // 计算趋势指标
        // 生成图表数据
        // 返回报告对象
    }
}
```

## 前端开发重点

### 数据可视化
使用ECharts或Chart.js实现：
- 健康指标趋势图
- 预警统计饼图
- 服务质量对比图
- 人群分布统计

### 表单验证
```javascript
const elderlyFormRules = {
  name: [
    { required: true, message: '请输入姓名', trigger: 'blur' },
    { min: 2, max: 20, message: '姓名长度在2到20个字符', trigger: 'blur' }
  ],
  idCard: [
    { required: true, message: '请输入身份证号', trigger: 'blur' },
    { pattern: /^[1-9]\d{5}(19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[0-9Xx]$/, 
      message: '身份证号格式不正确', trigger: 'blur' }
  ]
}
```

### 权限控制
```javascript
// 路由守卫
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('token')
  const userRole = localStorage.getItem('userRole')
  
  if (to.meta.requiresAuth && !token) {
    next('/login')
  } else if (to.meta.roles && !to.meta.roles.includes(userRole)) {
    next('/403')
  } else {
    next()
  }
})
```

## 性能优化建议

### 后端优化
- 使用Redis缓存热点数据
- 数据库连接池配置优化
- 分页查询避免深度分页
- 异步处理耗时操作

### 前端优化
- 组件懒加载
- 图片懒加载
- 虚拟滚动处理大列表
- 防抖节流优化用户交互

当您需要实现具体功能时，请参考这些指导原则，我会帮助您生成符合项目需求的高质量代码。
